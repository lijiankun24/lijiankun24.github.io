<!doctype html>



  


<html class="theme-next pisces use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Http,ReadingNotes," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="本文是《图解HTTP》读书笔记的第二篇，主要包括此书的第六章内容，因为第六章的内容较多，而且比较重要，所以单独写为一篇文章。主要内容是 HTTP 的首部，包括以下六点内容：

HTTP 首部简介
HTTP/1.1 通用首部字段
请求首部字段
响应首部字段
实体首部字段
其他">
<meta property="og:type" content="article">
<meta property="og:title" content="《图解HTTP》读书笔记（二）">
<meta property="og:url" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/index.html">
<meta property="og:site_name" content="一些无处安放的代码和故事">
<meta property="og:description" content="本文是《图解HTTP》读书笔记的第二篇，主要包括此书的第六章内容，因为第六章的内容较多，而且比较重要，所以单独写为一篇文章。主要内容是 HTTP 的首部，包括以下六点内容：

HTTP 首部简介
HTTP/1.1 通用首部字段
请求首部字段
响应首部字段
实体首部字段
其他">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/cache-control.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/cache-private.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/no-cache.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/max-age.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/min-fresh.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/connection1.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/connection2.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/pragma.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/trailer.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/upgrade.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/via.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/accept.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/accept-charset.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/accept-language.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/authorication.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/host.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/if.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/if-match.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/if-modified-since.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/if-none-match.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/if-range1.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/if-range2.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/max-forward.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/referer.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/user-agent.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/response.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/accept-ranges.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/age.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/ETag.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/location.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/retry-after.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/vary.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/content-header.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/allow.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/content_encoding.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/content-md5.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/content-range.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/expires.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/last-modified.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/cookie1.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/cookie2.png">
<meta property="og:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/dnt.png">
<meta property="og:updated_time" content="2017-09-09T03:00:14.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="《图解HTTP》读书笔记（二）">
<meta name="twitter:description" content="本文是《图解HTTP》读书笔记的第二篇，主要包括此书的第六章内容，因为第六章的内容较多，而且比较重要，所以单独写为一篇文章。主要内容是 HTTP 的首部，包括以下六点内容：

HTTP 首部简介
HTTP/1.1 通用首部字段
请求首部字段
响应首部字段
实体首部字段
其他">
<meta name="twitter:image" content="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/cache-control.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/"/>





  <title> 《图解HTTP》读书笔记（二） | 一些无处安放的代码和故事 </title>
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  














  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">一些无处安放的代码和故事</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.lijiankun24.com/《图解HTTP》读书笔记（二）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lijiankun24">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一些无处安放的代码和故事">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                《图解HTTP》读书笔记（二）
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-09-02T23:42:53+08:00">
                2017-09-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/《图解HTTP》读书笔记（二）/" class="leancloud_visitors" data-flag-title="《图解HTTP》读书笔记（二）">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Views </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>本文是《图解HTTP》读书笔记的第二篇，主要包括此书的第六章内容，因为第六章的内容较多，而且比较重要，所以单独写为一篇文章。主要内容是 <code>HTTP</code> 的首部，包括以下六点内容：</p>
<ol>
<li><code>HTTP</code> 首部简介</li>
<li><code>HTTP/1.1</code> 通用首部字段</li>
<li>请求首部字段</li>
<li>响应首部字段</li>
<li>实体首部字段</li>
<li>其他<a id="more"></a>
</li>
</ol>
<h2 id="1-HTTP-首部简介"><a href="#1-HTTP-首部简介" class="headerlink" title="1. HTTP 首部简介"></a>1. HTTP 首部简介</h2><p><code>HTTP</code> 协议的请求和响应报文中必定包含 <code>HTTP</code> 首部。首部内容为客户端和服务器分别处理请求和响应提供所需要的信息。</p>
<p>在报文众多的字段当中，HTTP 首部字段包含的信息最为丰富。首部字段同时存在于请求和响应报文内，并涵盖 HTTP 报文相关的内容信息。</p>
<h3 id="1-1-HTTP-请求报文"><a href="#1-1-HTTP-请求报文" class="headerlink" title="1.1 HTTP 请求报文"></a>1.1 HTTP 请求报文</h3><p>在请求中，HTTP 报文由方法、URI、HTTP 版本、HTTP 首部字段等部分构成。</p>
<h3 id="1-2-HTTP-响应报文"><a href="#1-2-HTTP-响应报文" class="headerlink" title="1.2 HTTP 响应报文"></a>1.2 HTTP 响应报文</h3><p>在响应中，HTTP 报文由 HTTP 版本、状态码（数字和原因短语）、HTTP 首部字段 3 部分组成。</p>
<h3 id="1-3-HTTP-首部字段传递重要信息"><a href="#1-3-HTTP-首部字段传递重要信息" class="headerlink" title="1.3 HTTP 首部字段传递重要信息"></a>1.3 HTTP 首部字段传递重要信息</h3><p>HTTP 首部字段是构成 HTTP 报文的要素之一。在客户端与服务器之间以 HTTP 协议进行通信的过程中，无论是请求还是响应都会使用首部字段，它能起到传递额外重要信息的作用。</p>
<p>使用首部字段是为了给浏览器和服务器提供报文主体大小、所使用的语言、认证信息等内容。</p>
<h3 id="1-4-HTTP-首部字段结构"><a href="#1-4-HTTP-首部字段结构" class="headerlink" title="1.4 HTTP 首部字段结构"></a>1.4 HTTP 首部字段结构</h3><p>HTTP 首部字段是由首部字段名和字段值构成的，中间用冒号 “：” 分隔。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">首部字段名：字段值</div></pre></td></tr></table></figure></p>
<p>例如在 HTTP 首部中以 <code>Content-Type</code> 这个字段来表示报文主体的对象类型。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Content-Type：text/html</div></pre></td></tr></table></figure></p>
<p>字段名是：<code>Content-Type</code>，字段值是：<code>text/html</code>。<br>另外，字段值对应单个 HTTP 首部字段可以有多个值，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Keep-Alive：timeout=15，max=100</div></pre></td></tr></table></figure></p>
<blockquote>
<p>若 HTTP 首部字段重复了会如何？</p>
<p>   当 HTTP 报文首部中出现了两个或两个以上具有相同首部字段名时会怎么样？这种情况在规范内尚未明确，根据浏览器内部处理逻辑的不同，结果可能并不一样。有些浏览器会优先处理第一次出现的首部字段，而有些则会优先处理最后出现的首部字段。</p>
</blockquote>
<h3 id="1-5-四种-HTTP-首部字段类型"><a href="#1-5-四种-HTTP-首部字段类型" class="headerlink" title="1.5 四种 HTTP 首部字段类型"></a>1.5 四种 HTTP 首部字段类型</h3><p>HTTP 首部字段根据实际用途被分为以下 4 种类型：</p>
<ul>
<li>通用首部字段：请求和响应报文两方都会使用的字段</li>
<li>请求首部字段：从客户端向服务器发送请求报文时使用的首部。补充了请求的附加内容、客户端信息、响应内容相关优先级等信息。</li>
<li>响应首部字段：从服务器向客户端返回响应报文时使用的首部。补充了响应的附加内容，也会要求客户端附加额外的内容信息</li>
<li>实体首部字段：针对请求报文和响应报文的实体部分使用的首部。补充了资源内容更新时间等与实体有关的信息。</li>
</ul>
<h3 id="1-6-End-to-end-首部和-Hop-by-hop-首部"><a href="#1-6-End-to-end-首部和-Hop-by-hop-首部" class="headerlink" title="1.6 End-to-end 首部和 Hop-by-hop 首部"></a>1.6 End-to-end 首部和 Hop-by-hop 首部</h3><p>HTTP 首部字段将定义成缓存代理和非缓存代理的行为，分为 2 种类型：</p>
<p>端到端首部（End-to-end Header）：分在此类别中的首部会转发给请求/响应对应的最终接受目标，且必须保持在缓存生成的响应中，另外规定它必须被转发。</p>
<p>逐跳首部（Htp-by-hop Header）：分在此类别中的首部只对单次转发有效，会因通过缓存或代理而不再转发。HTTP/1.1 和之后版本中，如果要使用 hop-by-hop 首部，需提供 Connection 首部字段。</p>
<p>下面列举了 HTTP/1.1 中的逐跳首部字段。除这 8 个首部字段之外，其他所有字段都属于端到端首部。</p>
<ul>
<li>Connection</li>
<li>Kttp-Alive</li>
<li>Proxy-Authenticate</li>
<li>Proxy-Authorization</li>
<li>Trailer</li>
<li>TE</li>
<li>Transfer-Encoding</li>
<li>Upgrade</li>
</ul>
<h2 id="2-HTTP-1-1-通用首部字段"><a href="#2-HTTP-1-1-通用首部字段" class="headerlink" title="2. HTTP/1.1 通用首部字段"></a>2. HTTP/1.1 通用首部字段</h2><p>通用首部字段是指，请求报文和响应报文双方都会使用的首部。</p>
<h3 id="2-1-Cache-Control"><a href="#2-1-Cache-Control" class="headerlink" title="2.1 Cache-Control"></a>2.1 Cache-Control</h3><p>通过制定首部字段 <code>Cache-Control</code> 的指令，就能操作缓存的工作机制。指令的参数是可选的，多个指令之间用<code>，</code>分割。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/cache-control.png" width="492" height="246"><br></div>

<h4 id="2-1-1-Cache-Control-指令一览"><a href="#2-1-1-Cache-Control-指令一览" class="headerlink" title="2.1.1 Cache-Control 指令一览"></a>2.1.1 Cache-Control 指令一览</h4><p>  可用的指令按请求和响应分类如下所示：</p>
<ul>
<li>缓存请求指令：</li>
</ul>
<table>
<thead>
<tr>
<th>指令</th>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>no-cache</td>
<td>无</td>
<td>强制向源服务器再次验证</td>
</tr>
<tr>
<td>no-store</td>
<td>无</td>
<td>不缓存请求或响应的任何内容</td>
</tr>
<tr>
<td>max-age = [秒]</td>
<td>必需</td>
<td>响应的最大 Age 值</td>
</tr>
<tr>
<td>max-stale （= [秒]）</td>
<td>可省略</td>
<td>接收已过期的响应</td>
</tr>
<tr>
<td>min-fresh = [秒]</td>
<td>必需</td>
<td>期望在指定时间内的响应仍有效</td>
</tr>
<tr>
<td>no-transform</td>
<td>无</td>
<td>代理不可更改媒体类型</td>
</tr>
<tr>
<td>only-if-cached</td>
<td>无</td>
<td>从缓存获取资源</td>
</tr>
<tr>
<td>cache-extention</td>
<td>-</td>
<td>新指令标记（token）</td>
</tr>
</tbody>
</table>
<ul>
<li>缓存响应指令：</li>
</ul>
<table>
<thead>
<tr>
<th>指令</th>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>public</td>
<td>无</td>
<td>可向任意方提供响应的缓存</td>
</tr>
<tr>
<td>private</td>
<td>可省略</td>
<td>仅向特定用户返回响应</td>
</tr>
<tr>
<td>no-cache</td>
<td>可省略</td>
<td>缓存前必须先确认其有效性</td>
</tr>
<tr>
<td>no-store</td>
<td>无</td>
<td>不缓存请求或响应的任何内容</td>
</tr>
<tr>
<td>no-transform</td>
<td>无</td>
<td>代理不可更改媒体类型</td>
</tr>
<tr>
<td>must-revalidate</td>
<td>无</td>
<td>可缓存但必须再向源服务器进行确认</td>
</tr>
<tr>
<td>proxy-revalidate</td>
<td>无</td>
<td>要求中间缓存服务器对缓存的响应有效性再次确认</td>
</tr>
<tr>
<td>max-age = [秒]</td>
<td>必需</td>
<td>响应的最大 Age 值</td>
</tr>
<tr>
<td>s-maxage = [秒]</td>
<td>必需</td>
<td>公共缓存服务器响应的最大 Age 值</td>
</tr>
<tr>
<td>cache-extention</td>
<td>-</td>
<td>新指令标记（token）</td>
</tr>
</tbody>
</table>
<ul>
<li><p>表示是否能缓存的指令</p>
<p><code>public</code> 指令：<code>Cache-Control：public</code>，当指定使用 <code>public</code> 指令时，则明确表明其他用户也可利用缓存。</p>
<p><code>private</code> 指令：<code>Cache-Control：private</code>，当指定 <code>private</code> 指令后，响应只以特定的用户作为对象，这与 <code>public</code> 指令的行为相反。缓存服务器会对特定用户提供资源缓存的服务，对于其他用户发送过来的请求，代理服务器则不会返回缓存了。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/cache-private.png" width="470" height="268"><br></div>

<p><code>no-cache</code> 指令：使用 <code>no-cache</code> 指令的目的是为了防止从缓存中返回过期的资源</p>
<ul>
<li>客户端的角度：客户端发送的请求中如果包含 <code>no-cache</code> 指令，则表示客户端将不会接收缓存过的响应。于是，”中间”的缓存服务器必须把客户端请求转发给源服务器。</li>
<li><p>服务器的角度：如果服务器返回的响应中包含 <code>no-cache</code> 指令，那么缓存服务器不能对资源进行缓存。源服务器以后也将不再对缓存服务器请求中提出的资源有效性进行确认，且禁止其对响应资源进行缓存操作。</p>
<blockquote>
<p>由服务器返回的响应中，若报文首部字段 <code>Cache-Control</code> 中对 <code>no-cache</code> 字段名具体制定参数值，那么客户端在接收到这个被制定参数值的首部字段对应的响应报文后，就不能使用缓存。换言之，无参数值的首部字段可以使用缓存。只能在响应指令中指定该参数。</p>
</blockquote>
<div align="center"><br>  <img src="/《图解HTTP》读书笔记（二）/no-cache.png" width="476" height="258"><br></div>
</li>
</ul>
</li>
<li><p>控制可执行缓存的对象的指令</p>
<p><code>no-store</code> 指令：<code>Cache-Control：no-store</code>，当使用 <code>no-store</code> 指令时，暗示请求或响应中包含机密信息。因此，该指令规定缓存不能在本地存储请求或响应的任一部分。</p>
</li>
<li><p>指定缓存期限和认证的指令</p>
<p><code>s-maxage</code> 指令：<code>Cache-Control：s-maxage=604800(单位：秒)</code>。<code>s-maxage</code> 指令的功能和 <code>max-age</code> 指令的相同，它们的不同点是 <code>s-maxage</code> 指令只适用于供多位用户使用的公共缓存服务器。也就是说，对于向同一用户重复返回响应的服务器来说，这个指令没有任何作用。另外，当使用 <code>s-maxage</code> 指令后，则直接忽略对 <code>Expires</code> 首部字段及 <code>max-age</code> 指令的处理。</p>
<p><code>max-age</code> 指令：<code>Cache-Control：max-age=604800(单位：秒)</code>。</p>
<ul>
<li>当客户端发送的请求中包含 <code>max-age</code> 指令时，如果判定缓存资源的缓存时间数值比指定时间的数值更小，那么客户端就接收缓存的资源。另外，当指定 <code>max-age</code> 值为 0，那么缓存服务器通常需要将请求转发给源服务器。</li>
<li>当服务器返回的响应中包含 <code>max-age</code> 指令时，缓存服务器将不对资源的有效性再做确认，而 <code>max-age</code> 数值代表资源保存为缓存的最长时间。<blockquote>
<p>应用 <code>HTTP/1.1</code> 版本的缓存服务器遇到同时存在 <code>Expires</code> 首部字段的情况时，会优先处理 <code>max-age</code> 指令，而忽略掉 <code>Expires</code> 首部字段。而 <code>HTTP/1.0</code> 版本的缓存服务器的情况却相反，<code>max-age</code> 指令会被忽略。</p>
</blockquote>
</li>
</ul>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/max-age.png" width="469" height="314"><br></div>

<p><code>min-fresh</code> 指令：<code>Cache-Control：min-fresh=60（单位：秒）</code>。<code>min-fresh</code> 指令要求缓存服务器返回至少还未过指定时间的资源缓存。比如，当指定 <code>min-fresh</code> 为 60 秒后，在这 60 秒以内如果有超过有效期限的资源都无法作为响应返回了。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/min-fresh.png" width="469" height="269"><br></div>

<p><code>max-stale</code> 指令：<code>Cache-Control：max-stale=3600（单位：秒）</code>。使用 <code>max-stale</code> 可指示缓存资源，即使过期也照常接收。如果指令未指定参数值，那么无论经过多久，客户端都会接收响应；如果指令中指定了具体参数，那么即使过期，只要仍处于 <code>max-stale</code> 指定的时间内，仍旧会被客户端接收。</p>
<p><code>only-if-cached</code> 指令：<code>Cache-Control：only-if-cached</code>。使用 <code>only-if-cached</code> 指令表示客户端仅在缓存服务器本地缓存目标资源的情况下才会要求其返回。换言之，该指令要求缓存服务器不重新加载响应，也不会再次确认资源有效性。若发生请求缓存服务器的本地缓存资源无响应，则返回状态码 <code>504 Gateway Timeout</code>。</p>
<p><code>must-revalidate</code> 指令：<code>Cache-Control：must-revalidate</code>。使用 <code>must-revalidate</code> 指令，代理会向源服务器验证即将返回的响应缓存目前是否仍然有效。若代理无法连通源服务器再次获取有效资源的话，缓存必须给客户端一条 504（Gateway Timeout）状态码。另外，使用 <code>must-revalidate</code> 指令会忽略 <code>max-stale</code> 指令，<code>must-revalidate</code> 的优先级比 <code>max-stale</code> 指令的优先级高。</p>
<p><code>proxy-revalidate</code> 指令：<code>Cache-Control：proxy-revalidate</code> 。<code>proxy-revalidate</code> 指令要求所有的缓存服务器在接收到客户端带有该指令的请求返回响应之前，必须再次验证缓存的有效性。</p>
<p><code>no-transform</code> 指令：<code>Cache-Control：no-transform</code>。使用 <code>no-transform</code> 指令规定无论是在请求还是响应中，缓存都不能改变实体主体的媒体类型。这样做可以防止缓存或代理压缩图片等类似操作。</p>
</li>
</ul>
<h3 id="2-2-Connection"><a href="#2-2-Connection" class="headerlink" title="2.2 Connection"></a>2.2 Connection</h3><p>Connection 首部字段具有如下两个作用：</p>
<ul>
<li>控制不再转发给代理的首部字段</li>
<li>管理持久连接</li>
</ul>
<ol>
<li><p>控制不再转发给代理的首部字段</p>
<p>在客户端发送请求或服务器返回响应内，使用 <code>Connection</code> 首部字段，可控制不再转发给代理的首部字段（即Hop-by-hop首部）。</p>
<div align="center"><br>   <img src="/《图解HTTP》读书笔记（二）/connection1.png" width="436" height="247"><br></div>
</li>
<li><p>管理持久连接<br>HTTP/1.1 的默认连接都是持久连接。为此，客户端会在持久连接上发送请求。当服务器端想明确断开连接时，则指定 <code>Connection</code> 首部字段的值为 <code>Close</code> 。</p>
<p>HTTP/1.1 之前的 HTTP 版本的默认连接都是非持久连接。为此，如果想在旧版本的 HTTP 协议上维持持续连接，则需要指定 <code>Connection</code> 首部字段的值为 <code>Keep-Alive</code>。</p>
<p>如下图所示，客户端发送请求给服务器时，服务器端会像下图那样加上首部字段 <code>Keep-Alive</code> 及首部字段 <code>Connection</code> 后返回响应。</p>
<div align="center"><br>   <img src="/《图解HTTP》读书笔记（二）/connection2.png" width="452" height="269"><br></div>

</li>
</ol>
<h3 id="2-3-Date"><a href="#2-3-Date" class="headerlink" title="2.3 Date"></a>2.3 Date</h3><p>首部字段 <code>Date</code> 表明创建 HTTP 报文的日期和时间。</p>
<h3 id="2-4-Pragma"><a href="#2-4-Pragma" class="headerlink" title="2.4 Pragma"></a>2.4 Pragma</h3><p><code>Pragma</code> 是 HTTP/1.1 之前版本的历史遗留字段，仅作为与 HTTP/1.0 的向后兼容而定义。规范定义的形式唯一，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Pragme：no-cache</div></pre></td></tr></table></figure></p>
<p>该首部字段属于通用首部字段，但只用在客户端发送的请求中。客户端会要求所有的中间服务器不返回缓存的资源。</p>
<p>所有的中间服务器如果都能以 HTTP/1.1 为基准，那直接采用 <code>Cache-Control：no-cache</code> 指定缓存的处理方式是最为理想的。但要整体掌握全部中间服务器使用的 HTTP 协议版本却是不现实的。因此，发送的请求会同时含有下面两个首部字段。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Cache-Control：no-cache</div><div class="line">Pragma：no-cache</div></pre></td></tr></table></figure></p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/pragma.png" width="402" height="173"><br></div>

<h3 id="2-5-Trailer"><a href="#2-5-Trailer" class="headerlink" title="2.5 Trailer"></a>2.5 Trailer</h3><p>首部字段 <code>Trailer</code> 会事先说明在报文主体后记录了哪些首部字段。该首部字段可应用在 HTTP/1.1 版本分块传输编码时。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/trailer.png" width="376" height="166"><br></div>

<h3 id="2-6-Transfer-Encoding"><a href="#2-6-Transfer-Encoding" class="headerlink" title="2.6 Transfer-Encoding"></a>2.6 Transfer-Encoding</h3><p>首部字段 <code>Transfer-Encoding</code> 规定了传输报文主体时采用的传输方式。</p>
<p>HTTP/1.1 的传输编码方式仅对分块传输编码有效。</p>
<h3 id="2-7-Upgrade"><a href="#2-7-Upgrade" class="headerlink" title="2.7 Upgrade"></a>2.7 Upgrade</h3><p>首部字段 <code>Upgrade</code> 用于检测 HTTP 协议及其他协议是否可使用更高的版本进行通信，其参数值可以用来指定一个完全不同的通信协议。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/upgrade.png" width="470" height="198"><br></div>

<p>上图用例中，首部字段 <code>Upgrade</code> 指定的值为 TLS/1.0。请注意此处两个字段首部字段的对应关系，<code>Connection</code> 的值被指定为 <code>Upgrade</code>。<code>Upgrade</code> 首部字段产生作用的 <code>Upgrade</code> 对象仅限于客户端和邻接服务器之间。因此，使用首部字段 <code>Upgrade</code> 时，还需要额外指定 <code>Connection：Upgrade</code>。</p>
<p>对于附有首部字段 <code>Upgrade</code> 的请求，服务器可用 <code>101 Switching Protocols</code> 状态码作为响应返回。</p>
<h3 id="2-8-Via"><a href="#2-8-Via" class="headerlink" title="2.8 Via"></a>2.8 Via</h3><p>使用首部字段 <code>Via</code> 是为了追踪客户端与服务器之间的请求和响应报文的传输路径。</p>
<p>报文经过代理或网关时，会先在首部字段 <code>Via</code> 中附加该服务器的信息，然后再进行转发。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/via.png" width="457" height="291"><br></div>

<p>首部字段 <code>Via</code> 不仅作用于追踪报文的转发，还可避免请求回环的发生。所以必须在经过代理时附加该首部字段内容。</p>
<p><code>Via</code> 首部是为了追踪传输路径，所以经常会和 <code>TRACE</code> 方法一起使用。比如，代理服务器接收到由 <code>TRACE</code> 方法发送过来的请求（其中：Max-Forwards：0）时，代理服务器就不能再转发该请求了。这种情况下，代理服务器会将自身的信息附加到 <code>Via</code> 首部后，返回该请求的响应。</p>
<h3 id="2-9-Warning"><a href="#2-9-Warning" class="headerlink" title="2.9 Warning"></a>2.9 Warning</h3><p>HTTP/1.1 的 <code>Warning</code> 首部通常会告知用户一些与缓存相关的问题的警告。</p>
<p><code>Warning</code> 首部的格式如下。最后的日期时间部分可省略。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Warning：[警告码][警告的主机：端口号]“[警告内容]”([日期时间])</div></pre></td></tr></table></figure></p>
<p>HTTP/1.1 中定义了 7 种警告。警告码对应的警告内容仅推荐参考。另外，警告码具备扩展性。</p>
<h2 id="3-请求首部字段"><a href="#3-请求首部字段" class="headerlink" title="3. 请求首部字段"></a>3. 请求首部字段</h2><p>请求首部字段是从客户端往服务器端发送请求报文中所使用的字段，用于补充请求的附加信息、客户端信息、对响应内容相关的优先级等内容。</p>
<h3 id="3-1-Accept"><a href="#3-1-Accept" class="headerlink" title="3.1 Accept"></a>3.1 Accept</h3><p><code>Accept</code> 首部字段可通知服务器，用户代理能够处理的媒体类型及媒体类型的相对优先级。可使用 <code>type/subtype</code> 这种形式，一次指定多种媒体类型。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/accept.png" width="449" height="206"><br></div>

<p>下面我们试举几个媒体类型的样子。</p>
<ul>
<li><p>文本文件</p>
<p>text/html，text/plain，text/css …</p>
<p>application/xhtml+xml，application/xml …</p>
</li>
<li><p>图片文件</p>
<p>image/jpeg，image/gif，image/png …</p>
</li>
<li><p>视频文件</p>
<p>video/mpeg，video/quicktime …</p>
</li>
<li><p>应用程序使用的二进制文件</p>
<p>application/octet-stream，application/zip …</p>
</li>
</ul>
<p>比如，如果浏览器不支持 PNG 图片的显示，那 Accept 就不指定 image/png，而指定可处理的 image/gif 和 image/jpeg 等图片类型。</p>
<p>若想要给显示的媒体类型增加优先级，则使用 q= 来额外表示权重值，用分号（；）进行分隔。权重值 q 的范围是 0~1 （可精确到小数点后3位），且1为最大值。不指定权重 q 值时，默认权重为 q=1.0。</p>
<p>当服务器提供多种内容时，将会首先返回权重值最高的媒体类型。</p>
<h3 id="3-2-Accept-Charset"><a href="#3-2-Accept-Charset" class="headerlink" title="3.2 Accept-Charset"></a>3.2 Accept-Charset</h3><p><code>Accept-Charset</code> 首部字段可用来通知服务器用户代理支持的字符集及字符集的相对优先顺序。另外，可一次性指定多种字符集。与首部字段 <code>Accept</code> 相同的是可用权重 q 值来表示相对优先级。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/accept-charset.png" width="548" height="336"><br></div>

<p>该首部字段应用于内容协商机制的服务器驱动协商。</p>
<h3 id="3-3-Accept-Encoding"><a href="#3-3-Accept-Encoding" class="headerlink" title="3.3 Accept-Encoding"></a>3.3 Accept-Encoding</h3><p><code>Accept-Encoding</code> 首部字段用来告知服务器用户代理支持的内容编码及内容编码的优先级顺序。可一次性指定多种内容编码。</p>
<p>下面试举出几个内容编码的例子。</p>
<ul>
<li>gzip：由文件压缩程序gzip（GNU zip）生成的编码格式（RFC1952），采用Lemepl-Ziv算法及32位循环冗余校验（CRC32）。</li>
<li>compress：由UNIX文件压缩程序compress生成的编码格式，采用Lemepel-Zip-Welch算法。</li>
<li>deflate：组合使用zlib格式及有deflate压缩算法生成的编码格式。</li>
<li>identity：不执行压缩或不会变化的默认编码格式。</li>
</ul>
<p>采用权重 q 值来表示相对优先级，这点与首部字段 <code>Accept</code> 相同。另外，也可使用星号（* ）作为通配符，指定任意的编码格式。</p>
<h3 id="3-4-Accept-Language"><a href="#3-4-Accept-Language" class="headerlink" title="3.4 Accept-Language"></a>3.4 Accept-Language</h3><p>首部字段 <code>Accept-Language</code> 用来告知服务器用户代理能够处理的自然语言集（指中文或英文等），以及自然语言的相对优先级。可一次指定多种自然语言集。</p>
<p>和 <code>Accept</code> 首部字段一样，按权重值 <code>q</code> 来表示相对优先级。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/accept-language.png" width="475" height="428"><br></div>

<h3 id="3-5-Authorization"><a href="#3-5-Authorization" class="headerlink" title="3.5 Authorization"></a>3.5 Authorization</h3><p>首部字段 <code>Authorization</code> 是用来告知服务器，用户代理的认证信息（证书值）。通常，想要通过服务器认证的用户代理会在接收到返回的 401 状态码响应后，把首部字段 <code>Authorization</code> 加入请求中。共用缓存在接收到含有 <code>Authorization</code> 首部字段的请求时的操作处理会略有差异。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/authorication.png" width="448" height="457"><br></div>

<h3 id="3-6-Expect"><a href="#3-6-Expect" class="headerlink" title="3.6 Expect"></a>3.6 Expect</h3><p>客户端使用首部字段 <code>Except</code> 来告知服务器，期望出现的某种特定行为。因服务器无法理解客户端的期望作出回应而发生错误时，会返回状态码 <code>417 Expectation Failed</code>。</p>
<p>客户端可以利用该首部字段，写明所期望的扩展。虽然 HTTP/1.1 规范只定义了 100-continue（状态码 100 Continue 之意）。</p>
<h3 id="3-7-From"><a href="#3-7-From" class="headerlink" title="3.7 From"></a>3.7 From</h3><p>首部字段 <code>From</code> 用来告知服务器使用用户代理的用户的电子邮件地址。</p>
<h3 id="3-8-Host"><a href="#3-8-Host" class="headerlink" title="3.8 Host"></a>3.8 Host</h3><p>首部字段 Host 会告知服务器，请求的资源所处的互联网主机名和端口号。<strong>Host 首部字段在 HTTP/1.1 规范内是唯一一个必须包含在请求内的首部字段。</strong></p>
<p><strong>首部字段 Host 和以单台服务器分配多个域名的虚拟主机的工作机制有很密切的关联，这是首部字段 Host 必须存在的意义。</strong></p>
<p>请求被发送至服务器时，请求中的主机名会用 IP 地址直接替换解决。但如果这时，相同的 IP 地址下部署运行着多个域名，那么服务器就会无法理解究竟是哪个域名对应的请求。因此，就需要使用首部字段 Host 来明确指出请求的主机名。若服务器未设定主机名，那直接发送一个空值即可。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/host.png" width="468" height="381"><br></div>


<h3 id="3-9-If-Match"><a href="#3-9-If-Match" class="headerlink" title="3.9 If-Match"></a>3.9 If-Match</h3><blockquote>
<p>形如 If-xxx 这种形式的请求首部字段，都可称为条件请求。服务器接收到附带条件的请求后，只有判断指定条件为真时，才会执行请求。</p>
</blockquote>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/if.png" width="379" height="233"><br></div>

<p>首部字段 <code>If-Match</code>，附属带条件之一，它会告知服务器匹配资源所用的实体标记（ETag）值。这时的服务器无法使用弱 ETag 值。</p>
<p>服务器会比对 <code>If-Match</code> 的字段值和资源的 ETag 值，仅当两者一致时，才会执行请求。反之，则返回状态码 <code>412 Precondition Failed</code> 的响应。</p>
<p>还可以使用星号（* ）指定 <code>If-Match</code> 的字段值。针对这种情况，服务器将会忽略 ETag 的值，只要资源存在就处理请求。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/if-match.png" width="462" height="529"><br></div>


<h3 id="3-10-If-Modified-Since"><a href="#3-10-If-Modified-Since" class="headerlink" title="3.10 If-Modified-Since"></a>3.10 If-Modified-Since</h3><p>首部字段 <code>If-Modified-Since</code>，附属带条件之一，它会告知服务器若 <code>If-Modified-Since</code> 字段值早于资源的更新时间，则希望能处理该请求。而在指定 <code>If-Modified-Since</code> 字段值的日期时间之后，如果请求的资源都没有过更新，则返回状态码 <code>304 Not Modified</code> 的响应。</p>
<p><code>If-Modified-Since</code> 用于确认代理或客户端拥有的本地资源的有效性。获取资源的更新日期时间，可通过确认首部字段 <code>Last-Modified</code> 来确定。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/if-modified-since.png" width="459" height="527"><br></div>

<h3 id="3-11-If-None-Match"><a href="#3-11-If-None-Match" class="headerlink" title="3.11 If-None-Match"></a>3.11 If-None-Match</h3><p> 首部字段 <code>If-None-Match</code> 属于附带条件之一。它和首部字段 <code>If-None-Match</code> 作用相反。用于指定 <code>If-None-Match</code> 字段值的实体标记(ETag) 值与请求资源的 ETag 不一致时，它就告知服务器处理请求。</p>
<p> 在 GET 或 HEAD 方法中使用首部字段 <code>If-None-Match</code> 可获取最新的资源。因此，这与使用首部字段 <code>If-Nodified-Since</code> 时有些类似。<br> <div align="center"><br>     <img src="/《图解HTTP》读书笔记（二）/if-none-match.png" width="470" height="289"><br> </div></p>
<h3 id="3-12-If-Range"><a href="#3-12-If-Range" class="headerlink" title="3.12 If-Range"></a>3.12 If-Range</h3><p>首部字段 <code>If-Range</code> 属于附带条件之一。它告知服务器若指定的 <code>If-Range</code> 字段值（ETag值或者时间）和请求资源的 ETag 值或时间相一致时，则作为范围请求处理。反之，则返回全体资源。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/if-range1.png" width="457" height="442"><br></div><br>—————<br><div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/if-range2.png" width="457" height="352"><br></div>

<h3 id="3-13-If-Unmodified-Since"><a href="#3-13-If-Unmodified-Since" class="headerlink" title="3.13 If-Unmodified-Since"></a>3.13 If-Unmodified-Since</h3><p>首部字段 <code>If-Unmodified-Since</code> 和首部字段 <code>If-Modified-Since</code> 的作用相反。它的作用是告知服务器，指定的请求资源只有在字段值内指定的日期时间之后，未发生更新的情况下，才能处理请求。如果在指定日期时间后发送了更新，则以状态码 <code>412 Precondition Failed</code> 作为响应返回。</p>
<h3 id="3-14-Max-Forwards"><a href="#3-14-Max-Forwards" class="headerlink" title="3.14 Max-Forwards"></a>3.14 Max-Forwards</h3><p>通过 <code>TRACE</code> 方法或 <code>OPTIONS</code> 方法，发送包含首部字段 <code>Max-Forwards</code> 的请求时，该字段以十进制整数形式指定可经过的服务器最大数目。服务器在往下一个服务器转发请求之前，会将 <code>Max-Forwards</code> 的值减 1 后重新赋值。当服务器接收到 <code>Max-Forwards</code> 值为 0 的请求时，则不再进行转发，而是直接返回响应。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/max-forward.png" width="460" height="191"><br></div>

<h3 id="3-15-Proxy-Authorization"><a href="#3-15-Proxy-Authorization" class="headerlink" title="3.15 Proxy-Authorization"></a>3.15 Proxy-Authorization</h3><p>接收到从代理服务器发来的认证质询时，客户端会发送包含首部字段 <code>Proxy-Authorization</code> 的请求，以告知服务器认证所需要的信息。</p>
<p>这个行为是与客户端和服务器之间的 HTTP 访问认证相类似的，不同之处在于，认证行为发生在客户端和代理之间。客户端和服务器之间的认证，使用首部字段 <code>Authorization</code> 可起到相同作用。</p>
<h3 id="3-16-Range"><a href="#3-16-Range" class="headerlink" title="3.16 Range"></a>3.16 Range</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Range：bytes=5001-10000</div></pre></td></tr></table></figure>
<p>对于只需要获取部分资源的范围请求，包含首部字段 Range 即可告知服务器资源的指定范围。上面的示例表示请求获取从第 5001 字节至第10000字节的资源。</p>
<p>接收到附带 Range 首部字段请求的服务器，会在处理请求之后返回状态码 <code>206 Partial Content</code> 的响应。无法处理该范围请求时，则会返回状态码 <code>200 OK</code> 的响应及全部资源。</p>
<h3 id="3-17-Referer"><a href="#3-17-Referer" class="headerlink" title="3.17 Referer"></a>3.17 Referer</h3><p>首部字段 <code>Referer</code> 会告知服务器请求的原始资源的 URI。<br>客户端一般都会发送 Referer 首部字段给服务器。但当直接在浏览器的地址栏输入 URI，或出于安全性的考虑时，也可以不发送该首部字段。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/referer.png" width="458" height="257"><br></div>

<h3 id="3-18-TE"><a href="#3-18-TE" class="headerlink" title="3.18 TE"></a>3.18 TE</h3><p>首部字段 TE 会告知服务器客户端能够处理响应的传输编码方式及相对优先级。它和首部字段 <code>Accept-Encoding</code> 的功能很相像，但是用于传输编码。</p>
<p>首部字段 TE 除指定传输编码之外，还可以指定伴随 trailer 字段的分块传输编码的方式。应用后者时，只需把 trailers 赋值给该字段值。</p>
<h3 id="3-19-User—Agent"><a href="#3-19-User—Agent" class="headerlink" title="3.19 User—Agent"></a>3.19 User—Agent</h3><p>首部字段 <code>User—Agent</code> 会将创建请求的浏览器和用户代理名称等信息传达给服务器。</p>
<p>由网络爬虫发起请求时，有可能会在字段内添加爬虫作者的电子邮件地址。此外，如果请求经过代理，那么中间也很可能被添加上代理服务器的名称。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/user-agent.png" width="355" height="384"><br></div>

<h2 id="4-响应首部字段"><a href="#4-响应首部字段" class="headerlink" title="4. 响应首部字段"></a>4. 响应首部字段</h2><p>响应首部字段是由服务器向客户端返回响应报文中所使用的字段，用于补充响应的附加信息、服务器信息，以及对客户端的附加要求等信息。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/response.png" width="376" height="184"><br></div>

<h3 id="4-1-Accept-Ranges"><a href="#4-1-Accept-Ranges" class="headerlink" title="4.1 Accept-Ranges"></a>4.1 Accept-Ranges</h3><p>首部字段 <code>Accept-Ranges</code> 是用来告知客户端服务器是否能处理范围请求，以指定获取服务器端某个部分的资源。</p>
<p>可指定的字段值有两种，可处理范围请求时指定其为 <code>bytes</code>，反之则指定为 <code>none</code>。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/accept-ranges.png" width="458" height="239"><br></div>

<h3 id="4-2-Age"><a href="#4-2-Age" class="headerlink" title="4.2 Age"></a>4.2 Age</h3><p>首部字段 <code>Age</code> 能告知客户端，源服务器在多久前创建了响应。字段值的单位为秒。</p>
<p>若创建该响应的服务器是缓存服务器，Age 值是指缓存后的响应再次发起认证到认证完成的时间值。代理创建响应时必须加上首部字段 Age。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/age.png" width="460" height="243"><br></div>

<h3 id="4-3-ETag"><a href="#4-3-ETag" class="headerlink" title="4.3 ETag"></a>4.3 ETag</h3><p>首部字段 ETag 能告知客户端实体标识。它是一种可将资源以字符串形式做唯一性标识的方式。服务器会为每份资源分配对应的 ETag 值。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/ETag.png" width="463" height="292"><br></div>

<p>另外，当资源更新时，ETag 值也需要更新。生成 ETag 值时，并没有统一的算法规则，而仅仅是由服务器来分配。</p>
<p>资源被缓存时，就会被分配唯一性标识。</p>
<blockquote>
<p>强 ETag 值和弱 ETag 值</p>
<p> ETag 中有强 ETag 值和弱 ETag 值之分。</p>
<p> 强 ETag 值：不论实体发生多么细微的变化都会改变其值。</p>
<p>弱 ETag 值：只用于提示资源是否相同。只有资源发生了根本改变，产生差异时才会改变 ETag 值。这时，会在字段值最开始处附加 W/。</p>
</blockquote>
<h3 id="4-4-Location"><a href="#4-4-Location" class="headerlink" title="4.4 Location"></a>4.4 Location</h3><div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/location.png" width="456" height="482"><br></div>

<p>使用首部字段 <code>Location</code> 可以将响应接收方引导至某个与请求 URI 位置不同的资源。</p>
<p>基本上，该字段会配合 3XX：Redirection 的响应，提供重定向的 URI。</p>
<p>几乎所有的浏览器在接收到包含首部字段 Location 的响应后，都会强制性地尝试对已提示的重定向资源的访问。</p>
<h3 id="4-5-Proxy-Authenticate"><a href="#4-5-Proxy-Authenticate" class="headerlink" title="4.5 Proxy-Authenticate"></a>4.5 Proxy-Authenticate</h3><p>首部字段 <code>Proxy-Authenticate</code> 会把由代理服务器所要求的认证信息发送给客户端。</p>
<p>它与客户端和服务器之间的 HTTP 访问认证的行为相似，不同之处在于其认证行为是在客户端与代理之间进行的。而客户端与服务器之间进行认证时，首部字段 <code>WWW-Authenticate</code> 有着相同的作用。</p>
<h3 id="4-6-Retry-After"><a href="#4-6-Retry-After" class="headerlink" title="4.6 Retry-After"></a>4.6 Retry-After</h3><p>首部字段 <code>Retry-After</code> 告知客户端应该在多久之后再次发送请求。主要配合状态码 <code>503 Service Unavailable</code> 响应，或 <code>3xx Redirect</code> 响应一起使用。</p>
<p>字段值可以指定为具体的日期时间，也可以是创建响应后的秒数。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/retry-after.png" width="408" height="144"><br></div>

<h3 id="4-7-Server"><a href="#4-7-Server" class="headerlink" title="4.7 Server"></a>4.7 Server</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Server：Apache/2.2.6 (Unix) PHP/5.2.5</div></pre></td></tr></table></figure>
<p>首部字段 <code>Server</code> 告知客户端当前服务器上安装的 HTTP 服务器应用程序的信息。不单单会标出服务器上的软件应用名称，还有可能包括版本号和安装时启用的可选项。</p>
<h3 id="4-8-Vary"><a href="#4-8-Vary" class="headerlink" title="4.8 Vary"></a>4.8 Vary</h3><div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/vary.png" width="454" height="442"><br></div>

<p>首部字段 <code>Vary</code> 可对缓存进行控制。源服务器会向代理服务器传达关于本地缓存使用方法的命令。</p>
<p>从代理服务器接收到源服务器返回包含 <code>Vary</code> 指定项的响应之后，若再要进行缓存，仅对请求中含有相同 <code>Vary</code> 指定首部字段的请求返回缓存。即使对相同资源发起请求，但由于 <code>Vary</code> 指定的首部字段不相同，因此必须要从源服务器重新获取资源。</p>
<h3 id="4-9-WWW-Authenticate"><a href="#4-9-WWW-Authenticate" class="headerlink" title="4.9 WWW-Authenticate"></a>4.9 WWW-Authenticate</h3><p>首部字段 <code>WWW-Authenticate</code> 用于 HTTP 访问认证。它会告知客户端适用于访问请求 URI 所指定资源的认证方案（Basic 或是 Digest）和带参数提示的质询（challenge）。状态码 401 Unauthorized 响应中，肯定带有首部字段 <code>WWW-Authenticate</code>。</p>
<h2 id="5-实体首部字段"><a href="#5-实体首部字段" class="headerlink" title="5. 实体首部字段"></a>5. 实体首部字段</h2><p>实体首部字段是包含在请求报文和响应报文中的实体部分所使用的首部，用于补充内容的更新时间等于实体相关的信息。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/content-header.png" width="408" height="231"><br></div>

<h3 id="5-1-Allow"><a href="#5-1-Allow" class="headerlink" title="5.1 Allow"></a>5.1 Allow</h3><p>首部字段 <code>Allow</code> 用于通知客户端能够支持 <code>Request-URI</code> 指定资源的所有 HTTP 方法。当服务器接收到不支持的 HTTP 方法时，会以状态码 405 Method Not Allowed 作为响应返回。与此同时，还会把所有能支持的 HTTP 方法写入首部字段 Allow 后返回。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/allow.png" width="457" height="205"><br></div>

<h3 id="5-2-Content-Encoding"><a href="#5-2-Content-Encoding" class="headerlink" title="5.2 Content-Encoding"></a>5.2 Content-Encoding</h3><p>首部字段 <code>Content-Encoding</code> 会告知客户端服务器对实体的主体部分选用的内容编码方式。内容编码是指在不丢失实体信息的前提下所进行的压缩。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/content_encoding.png" width="447" height="140"><br></div>

<p>主要采用以下四种编码方式：</p>
<ul>
<li>gzip</li>
<li>compress</li>
<li>deflate</li>
<li>identity</li>
</ul>
<h3 id="5-3-Content-Language"><a href="#5-3-Content-Language" class="headerlink" title="5.3 Content-Language"></a>5.3 Content-Language</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Content-Language：zh-CN</div></pre></td></tr></table></figure>
<p>首部字段 <code>Content-Language</code> 会告知客户端，实体主体使用的自然语言（指中文或英文等语言）。</p>
<h3 id="5-4-Content-Length"><a href="#5-4-Content-Length" class="headerlink" title="5.4 Content-Length"></a>5.4 Content-Length</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Content-Length：15000</div></pre></td></tr></table></figure>
<p>首部字段 <code>Content-Length</code> 表明了实体主体部分的大小（单位是字节）。对实体主体进行内容编码传输时，不能再使用 <code>Content-Length</code> 首部字段。</p>
<h3 id="5-5-Content-Location"><a href="#5-5-Content-Location" class="headerlink" title="5.5 Content-Location"></a>5.5 Content-Location</h3><p>首部字段 <code>Content-Location</code> 给出与报文主体部分相对于的 URI。和首部字段 <code>Location</code> 不同，<code>Content-Location</code> 表示的是报文主体返回资源对应的 URI。</p>
<h3 id="5-6-Content-MD5"><a href="#5-6-Content-MD5" class="headerlink" title="5.6 Content-MD5"></a>5.6 Content-MD5</h3><p>首部字段 <code>Content-MD5</code> 是一串由 MD5 算法生成的值，其目的在于检查报文主体在传输过程中是否保持完整，以及确认传输到达。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/content-md5.png" width="489" height="335"><br></div>

<h3 id="5-7-Content-Range"><a href="#5-7-Content-Range" class="headerlink" title="5.7 Content-Range"></a>5.7 Content-Range</h3><div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/content-range.png" width="444" height="410"><br></div>

<p>针对范围请求吗，返回响应时使用的首部字段 <code>Content-Range</code>，能告知客户端作为响应返回的实体的哪个部分符合范围请求。字段值以字节为单位，表示当前发送部分及整个实体大小。</p>
<h3 id="5-8-Content-Type"><a href="#5-8-Content-Type" class="headerlink" title="5.8 Content-Type"></a>5.8 Content-Type</h3><p>首部字段 <code>Content-Type</code> 说明了实体主体内对象的媒体类型。和首部字段 Accept 一样，字段值用 type/subtype 形式赋值。</p>
<h3 id="5-9-Expires"><a href="#5-9-Expires" class="headerlink" title="5.9 Expires"></a>5.9 Expires</h3><p>首部字段 <code>Expires</code> 会将资源失效的日期告知客户端。缓存服务器在接收到含有首部字段 <code>Expires</code> 的响应后，会以缓存来应答请求，在 <code>Expires</code> 字段值指定的时间之前，响应的副本会一直被保存。当超过指定的时间后，缓存服务器在请求发送过来时，会转向源服务器请求资源。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/expires.png" width="409" height="221"><br></div>

<p>源服务器不希望缓存服务器对资源缓存时，最好在 <code>Expires</code> 字段内写入与首部字段 <code>Date</code> 相同的时间值。</p>
<p>但是，当首部字段 <code>Cache-Control</code> 有指定 <code>max-age</code> 指令时，比起首部字段 <code>Expires</code>，会优先处理 <code>max-age</code> 指令。</p>
<h3 id="5-10-Last-Modified"><a href="#5-10-Last-Modified" class="headerlink" title="5.10 Last-Modified"></a>5.10 Last-Modified</h3><p>首部字段 <code>Last-Modified</code> 指明资源最终修改的时间。一般来说，这个值就是 Request-URI 指定资源被修改的时间。但类似使用 CGI 脚本进行动态数据处理时，该值有可能会变成数据最终修改时的时间。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/last-modified.png" width="408" height="217"><br></div>

<h2 id="6-其他"><a href="#6-其他" class="headerlink" title="6.其他"></a>6.其他</h2><h3 id="6-1-Cookie"><a href="#6-1-Cookie" class="headerlink" title="6.1 Cookie"></a>6.1 Cookie</h3><p>管理服务器与客户端之间状态的 Cookie，虽然没有被编入标准化 HTTP/1.1 的 RFC2616 中，但在 Web 网站方面得到了广泛的应用。</p>
<p>Cookie 的工作机制是用户识别及状态管理。Web 网站为了管理用户的状态会通过 Web 浏览器，把一些数据临时写入用户的计算机内。接着当用户访问该 Web 网站时，可通过通信方式取回之前发放的 Cookie。</p>
<p>调用 Cookie 时，由于可校验 Cookie 的有效期，以及发送方的域、路径、协议等信息，所以正规发布的 Cookie 内的数据不会因来自其他 Web 站点和攻击者的攻击而泄露。</p>
<div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/cookie1.png" width="465" height="281"><br></div><br><div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/cookie2.png" width="465" height="259"><br></div>

<h4 id="6-1-1-Set-Cookie"><a href="#6-1-1-Set-Cookie" class="headerlink" title="6.1.1 Set-Cookie"></a>6.1.1 Set-Cookie</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Set-Cookie：status=enable；expires=Tue，05 Jul 2011 07:26:31 GMT；path=/；domain=.hackr.jp;</div></pre></td></tr></table></figure>
<p>当服务器准备开始管理客户端的状态时，会事先告知各种信息。下面的表格列举了 <code>Set-Cookie</code> 的字段值。</p>
<table>
<thead>
<tr>
<th>属性</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>NAME=VALUE</td>
<td style="text-align:center">赋予 Cookie 的名称和其值（必需项）</td>
</tr>
<tr>
<td>expires=DATE</td>
<td style="text-align:center">Cookie 的有效期（若不明确指定则默认为浏览器关闭前为止）</td>
</tr>
<tr>
<td>path=PATH</td>
<td style="text-align:center">将服务器上的文件目录作为 Cookie 的适用对象（若不指定则默认为文档所在的文件目录）</td>
</tr>
<tr>
<td>domain=域名</td>
<td style="text-align:center">作为 Cookie 适用对象的域名（若不指定则默认为创建 Cookie 的服务器的域名）</td>
</tr>
<tr>
<td>Secure</td>
<td style="text-align:center">仅在 HTTPS 安全通信时才会发送 Cookie</td>
</tr>
<tr>
<td>HttpOnly</td>
<td style="text-align:center">加以限制，使 Cookie 不能被 JavaScript 脚本访问</td>
</tr>
</tbody>
</table>
<ul>
<li><p>expires 属性</p>
<p>Cookie 的 expires 属性指定浏览器可发送 Cookie 的有效期。</p>
<p>当省略 expires 属性时，其有效期仅限于维持浏览器会话（Session）时间段内。这通常限于浏览器应用程序被关闭之前。</p>
<p>另外，一旦 Cookie 从服务器端发送至客户端，服务器端就不存在可以显示删除 Cookie 的方法。但可通过覆盖已过期的 Cookie，实现对客户端 Cookie 的实质性删除操作</p>
</li>
<li><p>path 属性</p>
<p>Cookie 的 path 属性可用于限制指定 Cookie 的发送范围的文件目录。</p>
</li>
<li><p>domain 属性</p>
<p>通过 Cookie 的 domain 属性指定的域名可做到与结尾匹配一致。比如：当指定 example.com 后，除 example.com 以外，www.example.com 或 www2.example.com 等都可以发送 Cookie。</p>
<p>因此，除了针对具体指定的多个域名发送 Cookie 之外，不指定 domain 属性显得更安全。</p>
</li>
<li><p>secure 属性<br>Cookie 的 secure 属性用于限制 Web 页面仅在 HTTPS 安全连接时，才可以发送 Cookie。</p>
<p>发送 Cookie 时，指定 secure 属性的方法如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Set-Cookie：name-value；secure</div></pre></td></tr></table></figure>
<p>以上例子仅当在 <code>https://www.example.com/</code>(HTTPS) 安全连接的情况下才会进行 Cookie 的回收。也就是说，即使域名相同，<a href="http://www.example.com/(HTTP" target="_blank" rel="external">http://www.example.com/(HTTP</a>) 也不会发生 Cookie 回收行为。</p>
<p>当省略 secure 属性时，不论 HTTP 还是 HTTPS，都会对 Cookie 进行回收。</p>
</li>
<li><p>HttpOnly 属性<br>Cookie 的 HttpOnly 属性是 Cookie 的扩展功能，它使 JavaScript 脚本无法获取 Cookie。其主要目的为防止跨站脚本攻击（Cross-site scripting，XSS）对 Cookie 的信息窃取。</p>
<p>发送指定 HttpOnly 属性的 Cookie 的方法如下所示。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Set-Cookie：name-value；HttpOnly</div></pre></td></tr></table></figure>
<p>通过上述设置，通常从 Web 页面内还可以对 Cookie 进行读取操作。但使用 JavaScript 的 document.cookie 就无法读取附加 HttpOnly 属性后的 Cookie 的内容了。因此，也就无法在 XSS 中利用 JavaScript 劫持 Cookie 了。</p>
</li>
</ul>
<h4 id="6-1-2-Cookie"><a href="#6-1-2-Cookie" class="headerlink" title="6.1.2 Cookie"></a>6.1.2 Cookie</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Cookie：status=enable</div></pre></td></tr></table></figure>
<p>首部字段 Cookie 会告知服务器，当客户端想获得 HTTP 状态管理支持时，就会在请求中包含从服务器接收到的 Cookie。接收到多个 Cookie 时，同样可以以多个 Cookie 的形式发送。</p>
<h3 id="6-2-其他首部字段"><a href="#6-2-其他首部字段" class="headerlink" title="6.2 其他首部字段"></a>6.2 其他首部字段</h3><p>HTTP 首部字段是可以自行扩展的。所以在 Web 服务器和浏览器的应用上，会出现各种非标准的首部字段。以下是一些常用的首部字段：</p>
<ul>
<li>X-Frame-Options</li>
<li>X-XSS-Protection</li>
<li>DNT</li>
<li>P3P</li>
</ul>
<h4 id="6-2-1-X-Frame-Options"><a href="#6-2-1-X-Frame-Options" class="headerlink" title="6.2.1 X-Frame-Options"></a>6.2.1 X-Frame-Options</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">X-Frame-Options：DENY</div></pre></td></tr></table></figure>
<p>首部字段 <code>X-Frame-Options</code> 属于 HTTP 响应首部，用于控制网站内容在其他 Web 网站的 Frame 标签内的显示问题。其主要目的是为了防止点击劫持（clickjacking）攻击。</p>
<p>首部字段 <code>X-Frame-Options</code> 有以下两个可指定的字段值。</p>
<ul>
<li>DENY：拒绝</li>
<li>SAMEORIGIN：仅同源域名下的页面匹配时许可。（比如：当指定 <a href="http://hackr.jp/sample.html" target="_blank" rel="external">http://hackr.jp/sample.html</a> 页面为 SAMEORIGIN 时，那么 hackr.jp 上所有页面的 frame 都被允许可加载该页面，而 example.com 等其他域名的页面就不行了）</li>
</ul>
<h4 id="6-2-2-X-XSS-Protection"><a href="#6-2-2-X-XSS-Protection" class="headerlink" title="6.2.2 X-XSS-Protection"></a>6.2.2 X-XSS-Protection</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">X-XSS-Protection：1</div></pre></td></tr></table></figure>
<p>首部字段 <code>X-XSS-Protection</code> 属于 HTTP 响应首部，它是针对跨站脚本攻击（XSS)的一种对策，用于控制浏览器 XSS 防护机制的开关。</p>
<p>首部字段 <code>X-XSS-Protection</code> 可指定的字段值如下。</p>
<ul>
<li>0：将 XSS 过滤设置成无效状态</li>
<li>1：将 XSS 过滤设置成有效状态</li>
</ul>
<h4 id="6-2-3-DNT"><a href="#6-2-3-DNT" class="headerlink" title="6.2.3 DNT"></a>6.2.3 DNT</h4><div align="center"><br>    <img src="/《图解HTTP》读书笔记（二）/dnt.png" width="455" height="199"><br></div>

<p>首部字段 DNT 属于 HTTP 请求首部，其中 DNT 是 Do Not Track 的简称，意为拒绝个人信息被收集，是表示拒绝被精准广告追踪的一种方法。</p>
<p>首部字段 DNT 可指定的字段值如下：</p>
<ul>
<li>0：同意被追踪</li>
<li>1：拒绝被追踪</li>
</ul>
<p>由于首部字段 DNT 的功能具备有效性，所以 Web 服务器需要对 DNT 做对应的支持。</p>
<h4 id="6-2-4-P3P"><a href="#6-2-4-P3P" class="headerlink" title="6.2.4 P3P"></a>6.2.4 P3P</h4><p>首部字段 P3P 属于 HTTP 响应首部，通过利用 P3P 技术，可以让 Web 网站上的个人隐私变成一种仅供程序可理解的技术，以达到保护用户隐私的目的。</p>
<p>要进行 P3P 的设定，需按以下操作步骤进行。<br>步骤1：创建 P3P 隐私<br>步骤2：创建 P3P 隐私对照文件后，保存命名在 <code>/w2c/p3p.xml</code><br>步骤3：从 P3P 隐私中新建 Compact policies 后，输出到 HTTP 响应中</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Http/" rel="tag"># Http</a>
          
            <a href="/tags/ReadingNotes/" rel="tag"># ReadingNotes</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/《图解HTTP》读书笔记（一）/" rel="next" title="《图解HTTP》读书笔记（一）">
                <i class="fa fa-chevron-left"></i> 《图解HTTP》读书笔记（一）
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/Android-开发碎碎念1/" rel="prev" title="Android 开发碎碎念1">
                Android 开发碎碎念1 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="lijiankun24" />
          <p class="site-author-name" itemprop="name">lijiankun24</p>
           
              <p class="site-description motion-element" itemprop="description">守得云开见月明。</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">38</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">26</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/lijiankun24" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/lijiankun24" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.jianshu.com/u/1abe21b7ff5f" target="_blank" title="Jianshu">
                  
                    <i class="fa fa-fw fa-jianshu"></i>
                  
                  Jianshu
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://gank.io/post/published" title="匠心写作" target="_blank">匠心写作</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://blog.csdn.net/lmj623565791" title="Hongyang" target="_blank">Hongyang</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.liaohuqiu.net/cn/" title="Huqiu Liao" target="_blank">Huqiu Liao</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://drakeet.me/" title="drakeet" target="_blank">drakeet</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.jianshu.com/u/df40282480b4" title="小鄧子" target="_blank">小鄧子</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://yuweiguocn.github.io/" title="于卫国" target="_blank">于卫国</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-HTTP-首部简介"><span class="nav-number">1.</span> <span class="nav-text">1. HTTP 首部简介</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-HTTP-请求报文"><span class="nav-number">1.1.</span> <span class="nav-text">1.1 HTTP 请求报文</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-HTTP-响应报文"><span class="nav-number">1.2.</span> <span class="nav-text">1.2 HTTP 响应报文</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-HTTP-首部字段传递重要信息"><span class="nav-number">1.3.</span> <span class="nav-text">1.3 HTTP 首部字段传递重要信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-HTTP-首部字段结构"><span class="nav-number">1.4.</span> <span class="nav-text">1.4 HTTP 首部字段结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-5-四种-HTTP-首部字段类型"><span class="nav-number">1.5.</span> <span class="nav-text">1.5 四种 HTTP 首部字段类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-6-End-to-end-首部和-Hop-by-hop-首部"><span class="nav-number">1.6.</span> <span class="nav-text">1.6 End-to-end 首部和 Hop-by-hop 首部</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-HTTP-1-1-通用首部字段"><span class="nav-number">2.</span> <span class="nav-text">2. HTTP/1.1 通用首部字段</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-Cache-Control"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 Cache-Control</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-1-Cache-Control-指令一览"><span class="nav-number">2.1.1.</span> <span class="nav-text">2.1.1 Cache-Control 指令一览</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-Connection"><span class="nav-number">2.2.</span> <span class="nav-text">2.2 Connection</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-Date"><span class="nav-number">2.3.</span> <span class="nav-text">2.3 Date</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-Pragma"><span class="nav-number">2.4.</span> <span class="nav-text">2.4 Pragma</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-Trailer"><span class="nav-number">2.5.</span> <span class="nav-text">2.5 Trailer</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-6-Transfer-Encoding"><span class="nav-number">2.6.</span> <span class="nav-text">2.6 Transfer-Encoding</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-7-Upgrade"><span class="nav-number">2.7.</span> <span class="nav-text">2.7 Upgrade</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-8-Via"><span class="nav-number">2.8.</span> <span class="nav-text">2.8 Via</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-9-Warning"><span class="nav-number">2.9.</span> <span class="nav-text">2.9 Warning</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-请求首部字段"><span class="nav-number">3.</span> <span class="nav-text">3. 请求首部字段</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-Accept"><span class="nav-number">3.1.</span> <span class="nav-text">3.1 Accept</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-Accept-Charset"><span class="nav-number">3.2.</span> <span class="nav-text">3.2 Accept-Charset</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-Accept-Encoding"><span class="nav-number">3.3.</span> <span class="nav-text">3.3 Accept-Encoding</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-Accept-Language"><span class="nav-number">3.4.</span> <span class="nav-text">3.4 Accept-Language</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-Authorization"><span class="nav-number">3.5.</span> <span class="nav-text">3.5 Authorization</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-6-Expect"><span class="nav-number">3.6.</span> <span class="nav-text">3.6 Expect</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-7-From"><span class="nav-number">3.7.</span> <span class="nav-text">3.7 From</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-8-Host"><span class="nav-number">3.8.</span> <span class="nav-text">3.8 Host</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-9-If-Match"><span class="nav-number">3.9.</span> <span class="nav-text">3.9 If-Match</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-10-If-Modified-Since"><span class="nav-number">3.10.</span> <span class="nav-text">3.10 If-Modified-Since</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-11-If-None-Match"><span class="nav-number">3.11.</span> <span class="nav-text">3.11 If-None-Match</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-12-If-Range"><span class="nav-number">3.12.</span> <span class="nav-text">3.12 If-Range</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-13-If-Unmodified-Since"><span class="nav-number">3.13.</span> <span class="nav-text">3.13 If-Unmodified-Since</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-14-Max-Forwards"><span class="nav-number">3.14.</span> <span class="nav-text">3.14 Max-Forwards</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-15-Proxy-Authorization"><span class="nav-number">3.15.</span> <span class="nav-text">3.15 Proxy-Authorization</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-16-Range"><span class="nav-number">3.16.</span> <span class="nav-text">3.16 Range</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-17-Referer"><span class="nav-number">3.17.</span> <span class="nav-text">3.17 Referer</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-18-TE"><span class="nav-number">3.18.</span> <span class="nav-text">3.18 TE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-19-User—Agent"><span class="nav-number">3.19.</span> <span class="nav-text">3.19 User—Agent</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-响应首部字段"><span class="nav-number">4.</span> <span class="nav-text">4. 响应首部字段</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-Accept-Ranges"><span class="nav-number">4.1.</span> <span class="nav-text">4.1 Accept-Ranges</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-Age"><span class="nav-number">4.2.</span> <span class="nav-text">4.2 Age</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-ETag"><span class="nav-number">4.3.</span> <span class="nav-text">4.3 ETag</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-Location"><span class="nav-number">4.4.</span> <span class="nav-text">4.4 Location</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-5-Proxy-Authenticate"><span class="nav-number">4.5.</span> <span class="nav-text">4.5 Proxy-Authenticate</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-6-Retry-After"><span class="nav-number">4.6.</span> <span class="nav-text">4.6 Retry-After</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-7-Server"><span class="nav-number">4.7.</span> <span class="nav-text">4.7 Server</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-8-Vary"><span class="nav-number">4.8.</span> <span class="nav-text">4.8 Vary</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-9-WWW-Authenticate"><span class="nav-number">4.9.</span> <span class="nav-text">4.9 WWW-Authenticate</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-实体首部字段"><span class="nav-number">5.</span> <span class="nav-text">5. 实体首部字段</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-Allow"><span class="nav-number">5.1.</span> <span class="nav-text">5.1 Allow</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-Content-Encoding"><span class="nav-number">5.2.</span> <span class="nav-text">5.2 Content-Encoding</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-Content-Language"><span class="nav-number">5.3.</span> <span class="nav-text">5.3 Content-Language</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-4-Content-Length"><span class="nav-number">5.4.</span> <span class="nav-text">5.4 Content-Length</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-5-Content-Location"><span class="nav-number">5.5.</span> <span class="nav-text">5.5 Content-Location</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-6-Content-MD5"><span class="nav-number">5.6.</span> <span class="nav-text">5.6 Content-MD5</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-7-Content-Range"><span class="nav-number">5.7.</span> <span class="nav-text">5.7 Content-Range</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-8-Content-Type"><span class="nav-number">5.8.</span> <span class="nav-text">5.8 Content-Type</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-9-Expires"><span class="nav-number">5.9.</span> <span class="nav-text">5.9 Expires</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-10-Last-Modified"><span class="nav-number">5.10.</span> <span class="nav-text">5.10 Last-Modified</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-其他"><span class="nav-number">6.</span> <span class="nav-text">6.其他</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-Cookie"><span class="nav-number">6.1.</span> <span class="nav-text">6.1 Cookie</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#6-1-1-Set-Cookie"><span class="nav-number">6.1.1.</span> <span class="nav-text">6.1.1 Set-Cookie</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-1-2-Cookie"><span class="nav-number">6.1.2.</span> <span class="nav-text">6.1.2 Cookie</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-其他首部字段"><span class="nav-number">6.2.</span> <span class="nav-text">6.2 其他首部字段</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#6-2-1-X-Frame-Options"><span class="nav-number">6.2.1.</span> <span class="nav-text">6.2.1 X-Frame-Options</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-2-2-X-XSS-Protection"><span class="nav-number">6.2.2.</span> <span class="nav-text">6.2.2 X-XSS-Protection</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-2-3-DNT"><span class="nav-number">6.2.3.</span> <span class="nav-text">6.2.3 DNT</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-2-4-P3P"><span class="nav-number">6.2.4.</span> <span class="nav-text">6.2.4 P3P</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

<div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">lijiankun24</span>
  
</div>


<div>
  <span id="busuanzi_container_site_pv">
    Total views <span id="busuanzi_value_site_pv">   </span>
  </span>

  <span id="busuanzi_container_site_uv">
    |   Total visitors <span id="busuanzi_value_site_uv"/>
  </span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  





  



  
  

  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("tWG63sCRtLhi5NFeaXtWqtnv-gzGzoHsz", "lPLcNFpeOoNc6wr9PVX8XdbI");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  


  

  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      } else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>

</body>
</html>
